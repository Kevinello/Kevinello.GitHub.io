<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1,user-scalable=no"><title>Python-asyncioå¼‚æ­¥ç¼–ç¨‹åŸºç¡€ | Kevinello</title><meta name="keywords" content="åç«¯,å¹¶å‘ç¼–ç¨‹,Python,asyncio"><meta name="author" content="Kevinello"><meta name="copyright" content="Kevinello"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="å‰è¨€ asyncioæ˜¯Python 3.4ç‰ˆæœ¬å¼•å…¥çš„æ ‡å‡†åº“ï¼Œç›´æ¥å†…ç½®äº†å¯¹å¼‚æ­¥IOçš„æ”¯æŒï¼Œå¹¶ä¸”å¦‚ä»Šasyncioçš„å•çº¿ç¨‹å¼‚æ­¥æ€§èƒ½å·²ç»åšåˆ°ä¸Go &#x2F; NodeæŒå¹³ ç›®å‰è¿˜æ²¡æœ‰åŸºäºasyncioå¼€å‘å¤§å‹é¡¹ç›®çš„ç»å†ï¼ˆä¸»è¦è¿˜æ˜¯åœ¨ç”¨golangï¼‰  éœ€è¦äº†è§£çš„å‡ ä¸ªè¯  åç¨‹ï¼ˆcoroutineï¼‰ï¼šä¸çº¿ç¨‹å¾ˆç›¸ä¼¼ï¼Œä¸åŒä¹‹å¤„åœ¨äºå¤šåç¨‹æ˜¯åŒä¸€ä¸ªçº¿ç¨‹æ¥æ‰§è¡Œçš„ï¼Œè¿™æ ·å°±çœå»äº†çº¿ç¨‹åˆ‡æ¢çš„æ—¶é—´ï¼Œè€Œä¸”ä¸éœ€è¦å¤šçº¿ç¨‹çš„é”æœºåˆ¶äº†ï¼Œæ‰§"><meta property="og:type" content="article"><meta property="og:title" content="Python-asyncioå¼‚æ­¥ç¼–ç¨‹åŸºç¡€"><meta property="og:url" content="http://kevinello.ltd/2021/03/17/Python-asyncio%E5%BC%82%E6%AD%A5%E7%BC%96%E7%A8%8B%E5%9F%BA%E7%A1%80/index.html"><meta property="og:site_name" content="Kevinello"><meta property="og:description" content="å‰è¨€ asyncioæ˜¯Python 3.4ç‰ˆæœ¬å¼•å…¥çš„æ ‡å‡†åº“ï¼Œç›´æ¥å†…ç½®äº†å¯¹å¼‚æ­¥IOçš„æ”¯æŒï¼Œå¹¶ä¸”å¦‚ä»Šasyncioçš„å•çº¿ç¨‹å¼‚æ­¥æ€§èƒ½å·²ç»åšåˆ°ä¸Go &#x2F; NodeæŒå¹³ ç›®å‰è¿˜æ²¡æœ‰åŸºäºasyncioå¼€å‘å¤§å‹é¡¹ç›®çš„ç»å†ï¼ˆä¸»è¦è¿˜æ˜¯åœ¨ç”¨golangï¼‰  éœ€è¦äº†è§£çš„å‡ ä¸ªè¯  åç¨‹ï¼ˆcoroutineï¼‰ï¼šä¸çº¿ç¨‹å¾ˆç›¸ä¼¼ï¼Œä¸åŒä¹‹å¤„åœ¨äºå¤šåç¨‹æ˜¯åŒä¸€ä¸ªçº¿ç¨‹æ¥æ‰§è¡Œçš„ï¼Œè¿™æ ·å°±çœå»äº†çº¿ç¨‹åˆ‡æ¢çš„æ—¶é—´ï¼Œè€Œä¸”ä¸éœ€è¦å¤šçº¿ç¨‹çš„é”æœºåˆ¶äº†ï¼Œæ‰§"><meta property="og:locale" content="zh_CN"><meta property="og:image" content="https://kevinello-1302687393.cos.ap-hongkong.myqcloud.com/img/02141902_04_compressed.jpg"><meta property="article:published_time" content="2021-03-17T06:17:53.000Z"><meta property="article:modified_time" content="2022-04-09T15:00:29.745Z"><meta property="article:author" content="Kevinello"><meta property="article:tag" content="åç«¯"><meta property="article:tag" content="å¹¶å‘ç¼–ç¨‹"><meta property="article:tag" content="Python"><meta property="article:tag" content="asyncio"><meta name="twitter:card" content="summary"><meta name="twitter:image" content="https://kevinello-1302687393.cos.ap-hongkong.myqcloud.com/img/02141902_04_compressed.jpg"><link rel="shortcut icon" href="/imgs/K.jpg"><link rel="canonical" href="http://kevinello.ltd/2021/03/17/Python-asyncio%E5%BC%82%E6%AD%A5%E7%BC%96%E7%A8%8B%E5%9F%BA%E7%A1%80/"><link rel="preconnect" href="//cdn.jsdelivr.net"><link rel="preconnect" href="//www.google-analytics.com" crossorigin=""><link rel="preconnect" href="//hm.baidu.com"><link rel="preconnect" href="//busuanzi.ibruce.info"><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6/css/all.min.css" media="print" onload='this.media="all"'><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox.css" media="print" onload='this.media="all"'><script>var _hmt=_hmt||[];!function(){var e=document.createElement("script");e.src="https://hm.baidu.com/hm.js?d2a20aecba22b2eaf60183c4831d9a52";var t=document.getElementsByTagName("script")[0];t.parentNode.insertBefore(e,t)}()</script><script async src="https://www.googletagmanager.com/gtag/js?id=G-RV8K5FBVX5"></script><script>function gtag(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],gtag("js",new Date),gtag("config","G-RV8K5FBVX5")</script><script>const GLOBAL_CONFIG = { 
  root: '/',
  algolia: {"appId":"13UJR6CRNO","apiKey":"456e56f51ec27a1e13d67bef144f6747","indexName":"Kevinello_blog","hits":{"per_page":6},"languages":{"input_placeholder":"æœç´¢æ–‡ç« ","hits_empty":"æ‰¾ä¸åˆ°æ‚¨æŸ¥è¯¢çš„å†…å®¹ï¼š${query}","hits_stats":"æ‰¾åˆ° ${hits} æ¡ç»“æœï¼Œç”¨æ—¶ ${time} æ¯«ç§’"}},
  localSearch: undefined,
  translate: undefined,
  noticeOutdate: {"limitDay":180,"position":"top","messagePrev":"It has been","messageNext":"days since the last update, the content of the article may be outdated."},
  highlight: {"plugin":"highlighjs","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":false},
  copy: {
    success: 'å¤åˆ¶æˆåŠŸ',
    error: 'å¤åˆ¶é”™è¯¯',
    noSupport: 'æµè§ˆå™¨ä¸æ”¯æŒ'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: '',
  date_suffix: {
    just: 'åˆšåˆš',
    min: 'åˆ†é’Ÿå‰',
    hour: 'å°æ—¶å‰',
    day: 'å¤©å‰',
    month: 'ä¸ªæœˆå‰'
  },
  copyright: undefined,
  lightbox: 'fancybox',
  Snackbar: undefined,
  source: {
    justifiedGallery: {
      js: 'https://cdn.jsdelivr.net/npm/flickr-justified-gallery@2/dist/fjGallery.min.js',
      css: 'https://cdn.jsdelivr.net/npm/flickr-justified-gallery@2/dist/fjGallery.min.css'
    }
  },
  isPhotoFigcaption: false,
  islazyload: false,
  isAnchor: true
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE={title:"Python-asyncioå¼‚æ­¥ç¼–ç¨‹åŸºç¡€",isPost:!0,isHome:!1,isHighlightShrink:!1,isToc:!0,postUpdate:"2022-04-09 23:00:29"}</script><noscript><style>#nav{opacity:1}.justified-gallery img{opacity:1}#post-meta time,#recent-posts time{display:inline!important}</style></noscript><script>(win=>{
    win.saveToLocal = {
      set: function setWithExpiry(key, value, ttl) {
        if (ttl === 0) return
        const now = new Date()
        const expiryDay = ttl * 86400000
        const item = {
          value: value,
          expiry: now.getTime() + expiryDay,
        }
        localStorage.setItem(key, JSON.stringify(item))
      },

      get: function getWithExpiry(key) {
        const itemStr = localStorage.getItem(key)

        if (!itemStr) {
          return undefined
        }
        const item = JSON.parse(itemStr)
        const now = new Date()

        if (now.getTime() > item.expiry) {
          localStorage.removeItem(key)
          return undefined
        }
        return item.value
      }
    }
  
    win.getScript = url => new Promise((resolve, reject) => {
      const script = document.createElement('script')
      script.src = url
      script.async = true
      script.onerror = reject
      script.onload = script.onreadystatechange = function() {
        const loadState = this.readyState
        if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
        script.onload = script.onreadystatechange = null
        resolve()
      }
      document.head.appendChild(script)
    })
  
      win.activateDarkMode = function () {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      win.activateLightMode = function () {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }
      const t = saveToLocal.get('theme')
    
          if (t === 'dark') activateDarkMode()
          else if (t === 'light') activateLightMode()
        
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        if (asideStatus === 'hide') {
          document.documentElement.classList.add('hide-aside')
        } else {
          document.documentElement.classList.remove('hide-aside')
        }
      }
    
    const detectApple = () => {
      if(/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)){
        document.documentElement.classList.add('apple')
      }
    }
    detectApple()
    })(window)</script><link rel="stylesheet" href="//at.alicdn.com/t/font_2232093_k6128tldgy.css"><meta name="generator" content="Hexo 5.2.0"></head><body><div id="web_bg"></div><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img is-center"><img src="https://kevinello-1302687393.file.myqcloud.com/picgo/2022/04/11/myself-e3fde6.png" onerror='onerror=null,src="/img/friend_404.gif"' alt="avatar"></div><div class="site-data is-center"><div class="data-item"><a href="/archives/"><div class="headline">æ–‡ç« </div><div class="length-num">34</div></a></div><div class="data-item"><a href="/tags/"><div class="headline">æ ‡ç­¾</div><div class="length-num">79</div></a></div><div class="data-item"><a href="/categories/"><div class="headline">åˆ†ç±»</div><div class="length-num">6</div></a></div></div><hr><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i> <span>Home</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i> <span>Archives</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i> <span>Tags</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i> <span>Categories</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i> <span>Link</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i> <span>About</span></a></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header" style="background-image:url(https://kevinello-1302687393.cos.ap-hongkong.myqcloud.com/img/02141902_04_compressed.jpg)"><nav id="nav"><span id="blog_name"><a id="site-name" href="/">Kevinello</a></span><div id="menus"><div id="search-button"><a class="site-page social-icon search"><i class="fas fa-search fa-fw"></i> <span>æœç´¢</span></a></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i> <span>Home</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i> <span>Archives</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i> <span>Tags</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i> <span>Categories</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i> <span>Link</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i> <span>About</span></a></div></div><div id="toggle-menu"><a class="site-page"><i class="fas fa-bars fa-fw"></i></a></div></div></nav><div id="post-info"><h1 class="post-title">Python-asyncioå¼‚æ­¥ç¼–ç¨‹åŸºç¡€</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">å‘è¡¨äº</span><time class="post-meta-date-created" datetime="2021-03-17T06:17:53.000Z" title="å‘è¡¨äº 2021-03-17 14:17:53">2021-03-17</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">æ›´æ–°äº</span><time class="post-meta-date-updated" datetime="2022-04-09T15:00:29.745Z" title="æ›´æ–°äº 2022-04-09 23:00:29">2022-04-09</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/%E6%8A%80%E6%9C%AF%E6%96%87%E7%AB%A0/">æŠ€æœ¯æ–‡ç« </a></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-wordcount"><i class="far fa-file-word fa-fw post-meta-icon"></i><span class="post-meta-label">å­—æ•°æ€»è®¡:</span><span class="word-count">1.8k</span><span class="post-meta-separator">|</span><i class="far fa-clock fa-fw post-meta-icon"></i><span class="post-meta-label">é˜…è¯»æ—¶é•¿:</span><span>8åˆ†é’Ÿ</span></span><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" data-flag-title="Python-asyncioå¼‚æ­¥ç¼–ç¨‹åŸºç¡€"><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">é˜…è¯»é‡:</span><span id="busuanzi_value_page_pv"></span></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="post-content" id="article-container"><h2 id="å‰è¨€"><a class="markdownIt-Anchor" href="#å‰è¨€"></a> å‰è¨€</h2><p><code>asyncio</code>æ˜¯Python 3.4ç‰ˆæœ¬å¼•å…¥çš„æ ‡å‡†åº“ï¼Œç›´æ¥å†…ç½®äº†å¯¹å¼‚æ­¥IOçš„æ”¯æŒï¼Œå¹¶ä¸”å¦‚ä»Š<code>asyncio</code>çš„å•çº¿ç¨‹å¼‚æ­¥æ€§èƒ½å·²ç»åšåˆ°ä¸<code>Go</code> / <code>Node</code>æŒå¹³</p><p>ç›®å‰è¿˜æ²¡æœ‰åŸºäºasyncioå¼€å‘å¤§å‹é¡¹ç›®çš„ç»å†ï¼ˆä¸»è¦è¿˜æ˜¯åœ¨ç”¨<code>golang</code>ï¼‰</p><h2 id="éœ€è¦äº†è§£çš„å‡ ä¸ªè¯"><a class="markdownIt-Anchor" href="#éœ€è¦äº†è§£çš„å‡ ä¸ªè¯"></a> éœ€è¦äº†è§£çš„å‡ ä¸ªè¯</h2><ul><li><code>åç¨‹ï¼ˆcoroutineï¼‰</code>ï¼šä¸<strong>çº¿ç¨‹</strong>å¾ˆç›¸ä¼¼ï¼Œä¸åŒä¹‹å¤„åœ¨äºå¤šåç¨‹æ˜¯åŒä¸€ä¸ªçº¿ç¨‹æ¥æ‰§è¡Œçš„ï¼Œè¿™æ ·å°±çœå»äº†çº¿ç¨‹åˆ‡æ¢çš„æ—¶é—´ï¼Œè€Œä¸”ä¸éœ€è¦å¤šçº¿ç¨‹çš„é”æœºåˆ¶äº†ï¼Œæ‰§è¡Œæ•ˆç‡é«˜å¾ˆå¤š</li><li><code>å¼‚æ­¥IO</code>ï¼šå¼‚æ­¥IOçš„æ¦‚å¿µå’ŒåŒæ­¥IOç›¸å¯¹ã€‚å½“ä¸€ä¸ªå¼‚æ­¥è¿‡ç¨‹è°ƒç”¨å‘å‡ºåï¼Œè°ƒç”¨è€…ä¸èƒ½ç«‹åˆ»å¾—åˆ°ç»“æœã€‚å®é™…å¤„ç†è¿™ä¸ªè°ƒç”¨çš„éƒ¨ä»¶åœ¨å®Œæˆåï¼Œé€šè¿‡çŠ¶æ€ã€é€šçŸ¥å’Œå›è°ƒæ¥é€šçŸ¥è°ƒç”¨è€…</li><li><code>äº‹ä»¶å¾ªç¯</code>ï¼šäº‹ä»¶å¾ªç¯æ˜¯ä¸€ç§å¤„ç†å¤šå¹¶å‘é‡çš„æœ‰æ•ˆæ–¹å¼ï¼Œåœ¨ç»´åŸºç™¾ç§‘ä¸­å®ƒè¢«æè¿°ä¸ºã€Œä¸€ç§ç­‰å¾…ç¨‹åºåˆ†é…äº‹ä»¶æˆ–æ¶ˆæ¯çš„ç¼–ç¨‹æ¶æ„ã€ï¼Œæˆ‘ä»¬å¯ä»¥å®šä¹‰äº‹ä»¶å¾ªç¯æ¥ç®€åŒ–ä½¿ç”¨è½®è¯¢æ–¹æ³•æ¥ç›‘æ§äº‹ä»¶ï¼Œé€šä¿—çš„è¯´æ³•å°±æ˜¯ã€Œå½“Aå‘ç”Ÿæ—¶ï¼Œæ‰§è¡ŒBã€</li></ul><h2 id="asyncio-æ˜¯ä»€ä¹ˆ"><a class="markdownIt-Anchor" href="#asyncio-æ˜¯ä»€ä¹ˆ"></a> asyncio æ˜¯ä»€ä¹ˆ</h2><p><code>asyncio</code>æ¨¡å—æä¾›äº†ä½¿ç”¨åç¨‹æ„å»ºå¹¶å‘åº”ç”¨çš„å·¥å…·ï¼Œå®ƒä½¿ç”¨ä¸€ç§å•çº¿ç¨‹å•è¿›ç¨‹çš„çš„æ–¹å¼å®ç°å¹¶å‘ï¼Œåº”ç”¨çš„å„ä¸ªéƒ¨åˆ†å½¼æ­¤åˆä½œ, å¯ä»¥æ˜¾å¼çš„åˆ‡æ¢ä»»åŠ¡ï¼Œä¸€èˆ¬ä¼šåœ¨ç¨‹åºé˜»å¡I/Oæ“ä½œçš„æ—¶å€™å‘ç”Ÿä¸Šä¸‹æ–‡åˆ‡æ¢å¦‚ç­‰å¾…è¯»å†™æ–‡ä»¶,æˆ–è€…è¯·æ±‚ç½‘ç»œï¼›åŒæ—¶<code>asyncio</code>ä¹Ÿæ”¯æŒè°ƒåº¦ä»£ç åœ¨å°†æ¥çš„æŸä¸ªç‰¹å®šæ—¶é—´è¿è¡Œï¼Œä»è€Œæ”¯æŒä¸€ä¸ªåç¨‹ç­‰å¾…å¦ä¸€ä¸ªåç¨‹å®Œæˆï¼Œä»¥å¤„ç†ç³»ç»Ÿä¿¡å·å’Œè¯†åˆ«å…¶ä»–ä¸€äº›äº‹ä»¶</p><p>å…¶ä»–çš„å¹¶å‘æ¨¡å‹å¤§å¤šæ•°é‡‡å–çº¿æ€§çš„æ–¹å¼ç¼–å†™ï¼Œå¹¶ä¸”ä¾èµ–äºè¯­è¨€è¿è¡Œæ—¶ç³»ç»Ÿ / æ“ä½œç³»ç»Ÿçš„åº•å±‚çº¿ç¨‹ / è¿›ç¨‹æ¥é€‚å½“åœ°æ”¹å˜ä¸Šä¸‹æ–‡ï¼Œè€ŒåŸºäº<code>asyncio</code>çš„åº”ç”¨è¦æ±‚åº”ç”¨ä»£ç æ˜¾å¼åœ°å¤„ç†ä¸Šä¸‹æ–‡åˆ‡æ¢</p><h2 id="asyncioåŸºæœ¬ä½¿ç”¨"><a class="markdownIt-Anchor" href="#asyncioåŸºæœ¬ä½¿ç”¨"></a> asyncioåŸºæœ¬ä½¿ç”¨</h2><p><code>asyncio</code>çš„æ ¸å¿ƒç¼–ç¨‹æ¨¡å‹å°±æ˜¯ä¸€ä¸ªæ¶ˆæ¯å¾ªç¯ï¼Œæˆ‘ä»¬ä»<code>asyncio</code>æ¨¡å—ä¸­ç›´æ¥è·å–ä¸€ä¸ª<code>EventLoop</code>çš„å¼•ç”¨ï¼Œç„¶åæŠŠéœ€è¦æ‰§è¡Œçš„<a href="https://kevinello.ltd/2021/02/15/Python-yield%E5%85%B3%E9%94%AE%E5%AD%97%E8%AF%A6%E8%A7%A3/">åç¨‹</a>æ‰”åˆ°<code>EventLoop</code>ä¸­æ‰§è¡Œï¼Œå°±å®ç°äº†å¼‚æ­¥IO</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> threading</span><br><span class="line"><span class="keyword">import</span> asyncio</span><br><span class="line"></span><br><span class="line"><span class="meta">@asyncio.coroutine</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">my_coroutine</span>():</span></span><br><span class="line">    print(<span class="string">f&#x27;I ain\&#x27;t got no money (<span class="subst">&#123;threading.currentThread()&#125;</span>)&#x27;</span>)</span><br><span class="line">    <span class="keyword">yield</span> <span class="keyword">from</span> asyncio.sleep(<span class="number">1</span>)</span><br><span class="line">    print(<span class="string">f&#x27;Do not go gentle into that good night (<span class="subst">&#123;threading.currentThread()&#125;</span>)&#x27;</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    loopEvent = asyncio.get_event_loop()</span><br><span class="line">    tasks = [my_coroutine(), my_coroutine()]</span><br><span class="line">    loopEvent.run_until_complete(asyncio.wait(tasks))</span><br><span class="line">    loopEvent.close()</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>è¾“å‡ºï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">I ain&#39;t got no money (&lt;_MainThread(MainThread, started 14260)&gt;)</span><br><span class="line">I ain&#39;t got no money (&lt;_MainThread(MainThread, started 14260)&gt;)</span><br><span class="line">Do not go gentle into that good night (&lt;_MainThread(MainThread, started 14260)&gt;)</span><br><span class="line">Do not go gentle into that good night (&lt;_MainThread(MainThread, started 14260)&gt;)</span><br></pre></td></tr></table></figure><p>ç”±æ‰“å°çš„å½“å‰çº¿ç¨‹idå¯ä»¥çœ‹å‡ºï¼Œä¸¤ä¸ª<code>coroutine</code>æ˜¯ç”±åŒä¸€ä¸ªçº¿ç¨‹å¹¶å‘æ‰§è¡Œçš„</p><p>å¦‚æœæŠŠ<code>asyncio.sleep()</code>æ¢æˆçœŸæ­£çš„IOæ“ä½œï¼Œåˆ™å¤šä¸ª<code>coroutine</code>å°±å¯ä»¥ç”±ä¸€ä¸ªçº¿ç¨‹å¹¶å‘æ‰§è¡Œ</p><h2 id="async-await"><a class="markdownIt-Anchor" href="#async-await"></a> async / await</h2><p>Python 3.5å¼€å§‹å¼•å…¥äº†æ–°çš„è¯­æ³•<code>async</code>å’Œ<code>await</code>ï¼Œå¯ä»¥è®©coroutineçš„ä»£ç æ›´ç®€æ´æ˜“è¯»</p><p>ç”¨èµ·æ¥ä¹Ÿå¾ˆç®€å•ï¼Œåªéœ€è¦åšä¸¤ä»¶äº‹æƒ…ï¼š</p><ul><li>æŠŠ<code>@asyncio.coroutine</code>æ›¿æ¢ä¸º<code>async</code></li><li>æŠŠ<code>yield from</code>æ›¿æ¢ä¸º<code>await</code></li></ul><p>æ›´æ–°åçš„ä»£ç ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> threading</span><br><span class="line"><span class="keyword">import</span> asyncio</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">async</span> <span class="function"><span class="keyword">def</span> <span class="title">my_coroutine</span>():</span></span><br><span class="line">    print(<span class="string">f&#x27;I ain\&#x27;t got no money (<span class="subst">&#123;threading.currentThread()&#125;</span>)&#x27;</span>)</span><br><span class="line">    <span class="keyword">await</span> asyncio.sleep(<span class="number">1</span>)</span><br><span class="line">    print(<span class="string">f&#x27;Do not go gentle into that good night (<span class="subst">&#123;threading.currentThread()&#125;</span>)&#x27;</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    loopEvent = asyncio.get_event_loop()</span><br><span class="line">    tasks = [my_coroutine(), my_coroutine()]</span><br><span class="line">    loopEvent.run_until_complete(asyncio.wait(tasks))</span><br><span class="line">    loopEvent.close()</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>ç®€æ´ &amp; ä¼˜é›…</p><h2 id="åç¨‹ä¸­è°ƒç”¨æ™®é€šå‡½æ•°"><a class="markdownIt-Anchor" href="#åç¨‹ä¸­è°ƒç”¨æ™®é€šå‡½æ•°"></a> åç¨‹ä¸­è°ƒç”¨æ™®é€šå‡½æ•°</h2><p>åœ¨åç¨‹ä¸­å¯ä»¥é€šè¿‡è°ƒç”¨<code>EventLoop</code>å¯¹è±¡çš„<code>call_soon</code>ï¼Œ<code>call_later</code>ï¼Œ<code>call_at</code>æ–¹æ³•æ¥è°ƒç”¨æ™®é€šå‡½æ•°</p><h3 id="call_soon"><a class="markdownIt-Anchor" href="#call_soon"></a> call_soon</h3><p>å­—é¢æ„æ€ï¼Œç«‹å³è°ƒç”¨</p><p><code>call_soon(self, callback, *args, context=None)</code></p><blockquote><p>Arrange for a callback to be called as soon as possible.This operates as a FIFO queue: callbacks are called in theorder in which they are registered. Each callback will becalled exactly once.Any positional arguments after the callback will be passed tothe callback when it is called.</p></blockquote><p>åœ¨<strong>ä¸‹ä¸€ä¸ªè¿­ä»£çš„æ—¶é—´å¾ªç¯</strong>ä¸­ç«‹åˆ»è°ƒç”¨å›è°ƒå‡½æ•°ï¼Œçœ‹ä»£ç ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> threading</span><br><span class="line"><span class="keyword">import</span> asyncio</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">callback</span>(<span class="params">args</span>):</span></span><br><span class="line">    print(<span class="string">f&#x27;callback: <span class="subst">&#123;args&#125;</span> (<span class="subst">&#123;threading.currentThread()&#125;</span>)&#x27;</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">async</span> <span class="function"><span class="keyword">def</span> <span class="title">my_coroutine</span>(<span class="params">loop</span>):</span></span><br><span class="line">    print(<span class="string">f&#x27;I ain\&#x27;t got no money (<span class="subst">&#123;threading.currentThread()&#125;</span>)&#x27;</span>)</span><br><span class="line">    <span class="keyword">await</span> asyncio.sleep(<span class="number">1</span>)</span><br><span class="line">    loop.call_soon(callback, <span class="string">&#x27;first time&#x27;</span>)</span><br><span class="line">    loop.call_soon(callback, <span class="string">&#x27;second time&#x27;</span>)</span><br><span class="line">    print(<span class="string">f&#x27;Do not go gentle into that good night (<span class="subst">&#123;threading.currentThread()&#125;</span>)&#x27;</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    loopEvent = asyncio.get_event_loop()</span><br><span class="line">    tasks = [my_coroutine(loopEvent), my_coroutine(loopEvent)]</span><br><span class="line">    loopEvent.run_until_complete(asyncio.wait(tasks))</span><br><span class="line">    loopEvent.close()</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>è¾“å‡ºï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">I ain&#39;t got no money (&lt;_MainThread(MainThread, started 11056)&gt;)</span><br><span class="line">I ain&#39;t got no money (&lt;_MainThread(MainThread, started 11056)&gt;)</span><br><span class="line">Do not go gentle into that good night (&lt;_MainThread(MainThread, started 11056)&gt;)</span><br><span class="line">Do not go gentle into that good night (&lt;_MainThread(MainThread, started 11056)&gt;)</span><br><span class="line">callback: first time (&lt;_MainThread(MainThread, started 11056)&gt;)</span><br><span class="line">callback: second time (&lt;_MainThread(MainThread, started 11056)&gt;)</span><br><span class="line">callback: first time (&lt;_MainThread(MainThread, started 11056)&gt;)</span><br><span class="line">callback: second time (&lt;_MainThread(MainThread, started 11056)&gt;)</span><br></pre></td></tr></table></figure><h3 id="call_later"><a class="markdownIt-Anchor" href="#call_later"></a> call_later</h3><p>äº‹ä»¶å¾ªç¯åœ¨<code>delay</code>ä¸€å®šæ—¶é—´åæ‰§è¡Œ<code>callback</code>å‡½æ•°</p><p><code>call_later(self, delay, callback, *args, context=None)</code></p><blockquote><p>Arrange for a callback to be called at a given time.Return a Handle: an opaque object with a cancel() method thatcan be used to cancel the call.The delay can be an int or float, expressed in seconds. It isalways relative to the current time.Each callback will be called exactly once. If two callbacksare scheduled for exactly the same time, it undefined whichwill be called first.Any positional arguments after the callback will be passed tothe callback when it is called.</p></blockquote><p>ç›´æ¥çœ‹ä»£ç ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> threading</span><br><span class="line"><span class="keyword">import</span> asyncio</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">callback</span>(<span class="params">args</span>):</span></span><br><span class="line">    print(<span class="string">f&#x27;callback: <span class="subst">&#123;args&#125;</span> (<span class="subst">&#123;threading.currentThread()&#125;</span>)&#x27;</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">async</span> <span class="function"><span class="keyword">def</span> <span class="title">my_coroutine</span>(<span class="params">loop</span>):</span></span><br><span class="line">    print(<span class="string">f&#x27;I ain\&#x27;t got no money (<span class="subst">&#123;threading.currentThread()&#125;</span>)&#x27;</span>)</span><br><span class="line">    loop.call_later(<span class="number">0.4</span>, callback, <span class="string">&#x27;second time&#x27;</span>)</span><br><span class="line">    loop.call_soon(callback, <span class="string">&#x27;first time&#x27;</span>)</span><br><span class="line">    <span class="keyword">await</span> asyncio.sleep(<span class="number">0.5</span>)</span><br><span class="line">    print(<span class="string">f&#x27;Do not go gentle into that good night (<span class="subst">&#123;threading.currentThread()&#125;</span>)&#x27;</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    loopEvent = asyncio.get_event_loop()</span><br><span class="line">    tasks = [my_coroutine(loopEvent), my_coroutine(loopEvent)]</span><br><span class="line">    loopEvent.run_until_complete(asyncio.wait(tasks))</span><br><span class="line">    loopEvent.close()</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>è¾“å‡ºï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">I ain&#39;t got no money (&lt;_MainThread(MainThread, started 17904)&gt;)</span><br><span class="line">I ain&#39;t got no money (&lt;_MainThread(MainThread, started 17904)&gt;)</span><br><span class="line">callback: first time (&lt;_MainThread(MainThread, started 17904)&gt;)</span><br><span class="line">callback: first time (&lt;_MainThread(MainThread, started 17904)&gt;)</span><br><span class="line">callback: second time (&lt;_MainThread(MainThread, started 17904)&gt;)</span><br><span class="line">callback: second time (&lt;_MainThread(MainThread, started 17904)&gt;)</span><br><span class="line">Do not go gentle into that good night (&lt;_MainThread(MainThread, started 17904)&gt;)</span><br><span class="line">Do not go gentle into that good night (&lt;_MainThread(MainThread, started 17904)&gt;)</span><br></pre></td></tr></table></figure><h3 id="call_at"><a class="markdownIt-Anchor" href="#call_at"></a> call_at</h3><p><code>call_at(self, when, callback, *args, context=None)</code></p><blockquote><p>Like call_later(), but uses an absolute time.</p><p>Absolute time corresponds to the event loopâ€™s time() method.</p></blockquote><p>call_atç¬¬ä¸€ä¸ªå‚æ•°çš„å«ä¹‰ä»£è¡¨çš„æ˜¯ä¸€ä¸ªå•è°ƒæ—¶é—´ï¼Œå®ƒå’Œæˆ‘ä»¬å¹³æ—¶è¯´çš„ç³»ç»Ÿæ—¶é—´æœ‰ç‚¹å·®å¼‚ï¼Œ</p><p>è¿™é‡Œçš„æ—¶é—´æŒ‡çš„æ˜¯äº‹ä»¶å¾ªç¯å†…éƒ¨æ—¶é—´ï¼Œå¯ä»¥é€šè¿‡<code>loop.time()</code>è·å–ï¼Œç„¶åå¯ä»¥åœ¨æ­¤åŸºç¡€ä¸Šè¿›è¡Œæ“ä½œã€‚åé¢çš„å‚æ•°å’Œå‰é¢çš„ä¸¤ä¸ªæ–¹æ³•ä¸€æ ·ã€‚å®é™…ä¸Šcall_laterå†…éƒ¨å°±æ˜¯è°ƒç”¨çš„call_at</p><p>ä¸Šä»£ç ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> threading</span><br><span class="line"><span class="keyword">import</span> asyncio</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">callback</span>(<span class="params">args</span>):</span></span><br><span class="line">    print(<span class="string">f&#x27;callback: <span class="subst">&#123;args&#125;</span> (<span class="subst">&#123;threading.currentThread()&#125;</span>)&#x27;</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">async</span> <span class="function"><span class="keyword">def</span> <span class="title">my_coroutine</span>(<span class="params">loop</span>):</span></span><br><span class="line">    print(<span class="string">f&#x27;I ain\&#x27;t got no money (<span class="subst">&#123;threading.currentThread()&#125;</span>)&#x27;</span>)</span><br><span class="line">    loop.call_at(loop.time() + <span class="number">0.2</span>, callback, <span class="string">&#x27;second time&#x27;</span>)</span><br><span class="line">    loop.call_soon(callback, <span class="string">&#x27;first time&#x27;</span>)</span><br><span class="line">    <span class="keyword">await</span> asyncio.sleep(<span class="number">0.5</span>)</span><br><span class="line">    print(<span class="string">f&#x27;Do not go gentle into that good night (<span class="subst">&#123;threading.currentThread()&#125;</span>)&#x27;</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    loopEvent = asyncio.get_event_loop()</span><br><span class="line">    tasks = [my_coroutine(loopEvent), my_coroutine(loopEvent)]</span><br><span class="line">    loopEvent.run_until_complete(asyncio.wait(tasks))</span><br><span class="line">    loopEvent.close()</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>è¾“å‡ºï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">I ain&#39;t got no money (&lt;_MainThread(MainThread, started 18504)&gt;)</span><br><span class="line">I ain&#39;t got no money (&lt;_MainThread(MainThread, started 18504)&gt;)</span><br><span class="line">callback: first time (&lt;_MainThread(MainThread, started 18504)&gt;)</span><br><span class="line">callback: first time (&lt;_MainThread(MainThread, started 18504)&gt;)</span><br><span class="line">callback: second time (&lt;_MainThread(MainThread, started 18504)&gt;)</span><br><span class="line">callback: second time (&lt;_MainThread(MainThread, started 18504)&gt;)</span><br><span class="line">Do not go gentle into that good night (&lt;_MainThread(MainThread, started 18504)&gt;)</span><br><span class="line">Do not go gentle into that good night (&lt;_MainThread(MainThread, started 18504)&gt;)</span><br></pre></td></tr></table></figure></article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta">æ–‡ç« ä½œè€…:</span> <span class="post-copyright-info"><a href="mailto:undefined">Kevinello</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta">æ–‡ç« é“¾æ¥:</span> <span class="post-copyright-info"><a href="http://kevinello.ltd/2021/03/17/Python-asyncio%E5%BC%82%E6%AD%A5%E7%BC%96%E7%A8%8B%E5%9F%BA%E7%A1%80/">http://kevinello.ltd/2021/03/17/Python-asyncioå¼‚æ­¥ç¼–ç¨‹åŸºç¡€/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta">ç‰ˆæƒå£°æ˜:</span> <span class="post-copyright-info">æœ¬åšå®¢æ‰€æœ‰æ–‡ç« é™¤ç‰¹åˆ«å£°æ˜å¤–ï¼Œå‡é‡‡ç”¨ <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> è®¸å¯åè®®ã€‚è½¬è½½è¯·æ³¨æ˜æ¥è‡ª <a href="http://kevinello.ltd" target="_blank">Kevinello</a>ï¼</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/%E5%90%8E%E7%AB%AF/">åç«¯</a><a class="post-meta__tags" href="/tags/%E5%B9%B6%E5%8F%91%E7%BC%96%E7%A8%8B/">å¹¶å‘ç¼–ç¨‹</a><a class="post-meta__tags" href="/tags/Python/">Python</a><a class="post-meta__tags" href="/tags/asyncio/">asyncio</a></div><div class="post_share"><div class="social-share" data-image="https://kevinello-1302687393.cos.ap-hongkong.myqcloud.com/img/02141902_04_compressed.jpg" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/social-share.js/dist/css/share.min.css" media="print" onload='this.media="all"'><script src="https://cdn.jsdelivr.net/npm/social-share.js/dist/js/social-share.min.js" defer></script></div></div><nav class="pagination-post" id="pagination"><div class="prev-post pull-left"><a href="/2021/04/11/Redis%E5%86%85%E5%AD%98%E7%A2%8E%E7%89%87%E7%9A%84%E4%BA%A7%E7%94%9F%E4%B8%8E%E6%B8%85%E7%90%86/"><img class="prev-cover" src="https://kevinello-1302687393.cos.ap-hongkong.myqcloud.com/img/20210411164926.jpg" onerror='onerror=null,src="/img/404.jpg"' alt="cover of previous post"><div class="pagination-info"><div class="label">ä¸Šä¸€ç¯‡</div><div class="prev_info">Rediså†…å­˜ç¢ç‰‡çš„äº§ç”Ÿä¸æ¸…ç†</div></div></a></div><div class="next-post pull-right"><a href="/2021/02/15/Python-yield%E5%85%B3%E9%94%AE%E5%AD%97%E8%AF%A6%E8%A7%A3/"><img class="next-cover" src="https://kevinello-1302687393.cos.ap-hongkong.myqcloud.com/img/02141913_00.png" onerror='onerror=null,src="/img/404.jpg"' alt="cover of next post"><div class="pagination-info"><div class="label">ä¸‹ä¸€ç¯‡</div><div class="next_info">Python-yieldå…³é”®å­—è¯¦è§£</div></div></a></div></nav><div class="relatedPosts"><div class="headline"><i class="fas fa-thumbs-up fa-fw"></i><span>ç›¸å…³æ¨è</span></div><div class="relatedPosts-list"><div><a href="/2021/02/15/Python-yield%E5%85%B3%E9%94%AE%E5%AD%97%E8%AF%A6%E8%A7%A3/" title="Python-yieldå…³é”®å­—è¯¦è§£"><img class="cover" src="https://kevinello-1302687393.cos.ap-hongkong.myqcloud.com/img/02141913_00.png" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2021-02-15</div><div class="title">Python-yieldå…³é”®å­—è¯¦è§£</div></div></a></div><div><a href="/2021/02/07/Go%E5%8D%95%E4%BE%8B%E6%A8%A1%E5%BC%8F/" title="Goå•ä¾‹æ¨¡å¼"><img class="cover" src="https://kevinello-1302687393.cos.ap-hongkong.myqcloud.com/img/sunset3.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2021-02-07</div><div class="title">Goå•ä¾‹æ¨¡å¼</div></div></a></div><div><a href="/2020/11/27/Whosbug%E9%A1%B9%E7%9B%AE%E6%97%A5%E5%BF%971/" title="Whosbugé¡¹ç›®æ—¥å¿—1"><img class="cover" src="https://kevinello-1302687393.cos.ap-hongkong.myqcloud.com/img/night3.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2020-11-27</div><div class="title">Whosbugé¡¹ç›®æ—¥å¿—1</div></div></a></div><div><a href="/2021/02/08/Python%E6%97%A5%E5%BF%97%E7%AE%A1%E7%90%86/" title="Pythonæ—¥å¿—ç®¡ç†"><img class="cover" src="https://kevinello-1302687393.cos.ap-hongkong.myqcloud.com/img/street3.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2021-02-08</div><div class="title">Pythonæ—¥å¿—ç®¡ç†</div></div></a></div><div><a href="/2022/01/10/%E5%B0%8F%E5%88%AE%E5%88%AEScrapy/" title="å°åˆ®åˆ®Scrapy"><img class="cover" src="https://kevinello-1302687393.cos.ap-hongkong.myqcloud.com/img/20220110152859.png" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2022-01-10</div><div class="title">å°åˆ®åˆ®Scrapy</div></div></a></div><div><a href="/2020/11/29/DEM%E9%A1%B9%E7%9B%AE%E6%97%A5%E5%BF%97/" title="DEMé¡¹ç›®æ—¥å¿—"><img class="cover" src="https://kevinello-1302687393.cos.ap-hongkong.myqcloud.com/img/sky5.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2020-11-29</div><div class="title">DEMé¡¹ç›®æ—¥å¿—</div></div></a></div></div></div><hr><div id="post-comment"><div class="comment-head"><div class="comment-headline"><i class="fas fa-comments fa-fw"></i> <span>è¯„è®º</span></div><div id="comment-switch"><span class="first-comment">Utterances</span><span class="switch-btn"></span><span class="second-comment">Twikoo</span></div></div><div class="comment-wrap"><div><div id="utterances-wrap"></div></div><div><div id="twikoo-wrap"></div></div></div></div></div><div class="aside-content" id="aside-content"><div class="card-widget card-info"><div class="is-center"><div class="avatar-img"><img src="https://kevinello-1302687393.file.myqcloud.com/picgo/2022/04/11/myself-e3fde6.png" onerror='this.onerror=null,this.src="/img/friend_404.gif"' alt="avatar"></div><div class="author-info__name">Kevinello</div><div class="author-info__description"></div></div><div class="card-info-data is-center"><div class="card-info-data-item"><a href="/archives/"><div class="headline">æ–‡ç« </div><div class="length-num">34</div></a></div><div class="card-info-data-item"><a href="/tags/"><div class="headline">æ ‡ç­¾</div><div class="length-num">79</div></a></div><div class="card-info-data-item"><a href="/categories/"><div class="headline">åˆ†ç±»</div><div class="length-num">6</div></a></div></div><a id="card-info-btn" target="_blank" rel="noopener" href="https://github.com/kevinello"><i class="fab fa-github"></i><span>Follow Me</span></a><div class="card-info-social-icons is-center"><a class="social-icon" href="https://github.com/kevinello" target="_blank" title="Github"><i class="fab fa-github"></i></a><a class="social-icon" href="https://space.bilibili.com/23149976" target="_blank" title="Bilibili"><i class="iconfont icon-bilibili-fill"></i></a><a class="social-icon" href="mailto:kevinello42@gmail.com" target="_blank" title="Email"><i class="fas fa-envelope"></i></a></div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>ç›®å½•</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%89%8D%E8%A8%80"><span class="toc-number">1.</span> <span class="toc-text">å‰è¨€</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E9%9C%80%E8%A6%81%E4%BA%86%E8%A7%A3%E7%9A%84%E5%87%A0%E4%B8%AA%E8%AF%8D"><span class="toc-number">2.</span> <span class="toc-text">éœ€è¦äº†è§£çš„å‡ ä¸ªè¯</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#asyncio-%E6%98%AF%E4%BB%80%E4%B9%88"><span class="toc-number">3.</span> <span class="toc-text">asyncio æ˜¯ä»€ä¹ˆ</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#asyncio%E5%9F%BA%E6%9C%AC%E4%BD%BF%E7%94%A8"><span class="toc-number">4.</span> <span class="toc-text">asyncioåŸºæœ¬ä½¿ç”¨</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#async-await"><span class="toc-number">5.</span> <span class="toc-text">async &#x2F; await</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%8D%8F%E7%A8%8B%E4%B8%AD%E8%B0%83%E7%94%A8%E6%99%AE%E9%80%9A%E5%87%BD%E6%95%B0"><span class="toc-number">6.</span> <span class="toc-text">åç¨‹ä¸­è°ƒç”¨æ™®é€šå‡½æ•°</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#call_soon"><span class="toc-number">6.1.</span> <span class="toc-text">call_soon</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#call_later"><span class="toc-number">6.2.</span> <span class="toc-text">call_later</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#call_at"><span class="toc-number">6.3.</span> <span class="toc-text">call_at</span></a></li></ol></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>æœ€æ–°æ–‡ç« </span></div><div class="aside-list"><div class="aside-list-item"><a class="thumbnail" href="/2022/08/01/%E5%A4%A7%E4%B8%80%E7%BB%9F%E7%AC%A6%E5%8F%B7%E8%BF%98%E5%8E%9F/" title="å¤§ä¸€ç»Ÿç¬¦å·è¿˜åŸ"><img src="https://kevinello-1302687393.file.myqcloud.com/picgo/2022/08/03/image-20220803133758954-65fb61.png" onerror='this.onerror=null,this.src="/img/404.jpg"' alt="å¤§ä¸€ç»Ÿç¬¦å·è¿˜åŸ"></a><div class="content"><a class="title" href="/2022/08/01/%E5%A4%A7%E4%B8%80%E7%BB%9F%E7%AC%A6%E5%8F%B7%E8%BF%98%E5%8E%9F/" title="å¤§ä¸€ç»Ÿç¬¦å·è¿˜åŸ">å¤§ä¸€ç»Ÿç¬¦å·è¿˜åŸ</a><time datetime="2022-08-01T06:11:30.000Z" title="å‘è¡¨äº 2022-08-01 14:11:30">2022-08-01</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2022/07/17/%E6%B5%85%E8%B0%88%E6%B5%81%E7%A8%8B-in-2022/" title="æµ…è°ˆæµç¨‹ in 2022"><img src="http://kevinello-1302687393.file.myqcloud.com/picgo/2022/07/17/755134-27e050.png" onerror='this.onerror=null,this.src="/img/404.jpg"' alt="æµ…è°ˆæµç¨‹ in 2022"></a><div class="content"><a class="title" href="/2022/07/17/%E6%B5%85%E8%B0%88%E6%B5%81%E7%A8%8B-in-2022/" title="æµ…è°ˆæµç¨‹ in 2022">æµ…è°ˆæµç¨‹ in 2022</a><time datetime="2022-07-17T02:08:17.000Z" title="å‘è¡¨äº 2022-07-17 10:08:17">2022-07-17</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2022/06/13/Golang-panic-recover-%E8%AF%A6%E8%A7%A3/" title="Golang panic&amp;recover è¯¦è§£"><img src="http://kevinello-1302687393.file.myqcloud.com/picgo/2022/07/05/1-3N1cYeaexHSCofJq9fo3gQ-d27c5c.jpeg" onerror='this.onerror=null,this.src="/img/404.jpg"' alt="Golang panic&amp;recover è¯¦è§£"></a><div class="content"><a class="title" href="/2022/06/13/Golang-panic-recover-%E8%AF%A6%E8%A7%A3/" title="Golang panic&amp;recover è¯¦è§£">Golang panic&amp;recover è¯¦è§£</a><time datetime="2022-06-13T11:35:31.000Z" title="å‘è¡¨äº 2022-06-13 19:35:31">2022-06-13</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2022/06/08/%E4%B8%80%E6%AC%A1%E7%A3%81%E7%9B%98%E6%B8%85%E7%90%86%E5%AF%BC%E8%87%B4%E7%9A%84docker%E5%90%AF%E5%8A%A8%E5%A4%B1%E8%B4%A5/" title="ä¸€æ¬¡ç£ç›˜æ¸…ç†å¯¼è‡´çš„dockerå¯åŠ¨å¤±è´¥"><img src="http://kevinello-1302687393.file.myqcloud.com/picgo/2022/07/05/20020320162790-ac19c3.png" onerror='this.onerror=null,this.src="/img/404.jpg"' alt="ä¸€æ¬¡ç£ç›˜æ¸…ç†å¯¼è‡´çš„dockerå¯åŠ¨å¤±è´¥"></a><div class="content"><a class="title" href="/2022/06/08/%E4%B8%80%E6%AC%A1%E7%A3%81%E7%9B%98%E6%B8%85%E7%90%86%E5%AF%BC%E8%87%B4%E7%9A%84docker%E5%90%AF%E5%8A%A8%E5%A4%B1%E8%B4%A5/" title="ä¸€æ¬¡ç£ç›˜æ¸…ç†å¯¼è‡´çš„dockerå¯åŠ¨å¤±è´¥">ä¸€æ¬¡ç£ç›˜æ¸…ç†å¯¼è‡´çš„dockerå¯åŠ¨å¤±è´¥</a><time datetime="2022-06-08T11:11:19.000Z" title="å‘è¡¨äº 2022-06-08 19:11:19">2022-06-08</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2022/05/24/%E8%AE%B0%E4%B8%80%E6%AC%A1%E5%9B%BD%E5%AF%86%E8%90%BD%E5%9C%B0%E7%9A%84%E7%BB%8F%E5%8E%86/" title="è®°ä¸€æ¬¡å›½å¯†è½åœ°çš„ç»å†"><img src="http://kevinello-1302687393.file.myqcloud.com/picgo/2022/05/24/Asymmetric_encryption_-colored--86ce94.png" onerror='this.onerror=null,this.src="/img/404.jpg"' alt="è®°ä¸€æ¬¡å›½å¯†è½åœ°çš„ç»å†"></a><div class="content"><a class="title" href="/2022/05/24/%E8%AE%B0%E4%B8%80%E6%AC%A1%E5%9B%BD%E5%AF%86%E8%90%BD%E5%9C%B0%E7%9A%84%E7%BB%8F%E5%8E%86/" title="è®°ä¸€æ¬¡å›½å¯†è½åœ°çš„ç»å†">è®°ä¸€æ¬¡å›½å¯†è½åœ°çš„ç»å†</a><time datetime="2022-05-24T04:59:10.000Z" title="å‘è¡¨äº 2022-05-24 12:59:10">2022-05-24</time></div></div></div></div></div></div></main><footer id="footer" style="background-image:url(https://kevinello-1302687393.cos.ap-hongkong.myqcloud.com/img/02141902_04_compressed.jpg)"><div id="footer-wrap"><div class="copyright">&copy;2020 - 2022 By Kevinello</div><div class="framework-info"><span>æ¡†æ¶</span> <a target="_blank" rel="noopener" href="https://hexo.io">Hexo</a><span class="footer-separator">|</span><span>ä¸»é¢˜</span> <a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly</a></div><div class="footer_custom_text">ğŸ¥³ ğŸ¥³ ğŸ¥³ ğŸ¥³ ğŸ¥³</div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="é˜…è¯»æ¨¡å¼"><i class="fas fa-book-open"></i></button><button id="darkmode" type="button" title="æµ…è‰²å’Œæ·±è‰²æ¨¡å¼è½¬æ¢"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="å•æ å’ŒåŒæ åˆ‡æ¢"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside_config" type="button" title="è®¾ç½®"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="ç›®å½•"><i class="fas fa-list-ul"></i></button><a id="to_comment" href="#post-comment" title="ç›´è¾¾è¯„è®º"><i class="fas fa-comments"></i></a><button id="go-up" type="button" title="å›åˆ°é¡¶éƒ¨"><i class="fas fa-arrow-up"></i></button></div></div><div id="algolia-search"><div class="search-dialog"><nav class="search-nav"><span class="search-dialog-title">Algolia</span><button class="search-close-button"><i class="fas fa-times"></i></button></nav><div class="search-wrap"><div id="algolia-search-input"></div><hr><div id="algolia-search-results"><div id="algolia-hits"></div><div id="algolia-pagination"></div><div id="algolia-stats"></div></div></div></div><div id="search-mask"></div></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox.umd.js"></script><script src="https://cdn.jsdelivr.net/npm/algoliasearch@4/dist/algoliasearch-lite.umd.js"></script><script src="https://cdn.jsdelivr.net/npm/instantsearch.js@4/dist/instantsearch.production.min.js"></script><script src="/js/search/optimized_algolia.js"></script><div class="js-pjax"><script>if (!window.MathJax) {
  window.MathJax = {
    tex: {
      inlineMath: [ ['$','$'], ["\\(","\\)"]],
      tags: 'ams'
    },
    chtml: {
      scale: 1.2
    },
    options: {
      renderActions: {
        findScript: [10, doc => {
          for (const node of document.querySelectorAll('script[type^="math/tex"]')) {
            const display = !!node.type.match(/; *mode=display/)
            const math = new doc.options.MathItem(node.textContent, doc.inputJax[0], display)
            const text = document.createTextNode('')
            node.parentNode.replaceChild(text, node)
            math.start = {node: text, delim: '', n: 0}
            math.end = {node: text, delim: '', n: 0}
            doc.math.push(math)
          }
        }, ''],
        insertScript: [200, () => {
          document.querySelectorAll('mjx-container:not\([display]\)').forEach(node => {
            const target = node.parentNode
            if (target.nodeName.toLowerCase() === 'li') {
              target.parentNode.classList.add('has-jax')
            } else {
              target.classList.add('has-jax')
            }
          });
        }, '', false]
      }
    }
  }
  
  const script = document.createElement('script')
  script.src = 'https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js'
  script.id = 'MathJax-script'
  script.async = true
  document.head.appendChild(script)
} else {
  MathJax.startup.document.state(0)
  MathJax.texReset()
  MathJax.typeset()
}</script><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@latest/dist/katex.min.css"><script src="https://cdn.jsdelivr.net/npm/katex-copytex@latest/dist/katex-copytex.min.js"></script><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex-copytex@latest/dist/katex-copytex.min.css"><script>(() => {
  document.querySelectorAll('#article-container span.katex-display').forEach(item => {
    btf.wrap(item, 'div', { class: 'katex-wrap'})
  })
})()</script><script>(() => {
  const $mermaidWrap = document.querySelectorAll('#article-container .mermaid-wrap')
  if ($mermaidWrap.length) {
    window.runMermaid = () => {
      window.loadMermaid = true
      const theme = document.documentElement.getAttribute('data-theme') === 'dark' ? 'dark' : 'default'

      Array.from($mermaidWrap).forEach((item, index) => {
        const mermaidSrc = item.firstElementChild
        const mermaidThemeConfig = '%%{init:{ \'theme\':\'' + theme + '\'}}%%\n'
        const mermaidID = 'mermaid-' + index
        const mermaidDefinition = mermaidThemeConfig + mermaidSrc.textContent
        mermaid.mermaidAPI.render(mermaidID, mermaidDefinition, (svgCode) => {
          mermaidSrc.insertAdjacentHTML('afterend', svgCode)
        })
      })
    }

    const loadMermaid = () => {
      window.loadMermaid ? runMermaid() : getScript('https://cdn.jsdelivr.net/npm/mermaid/dist/mermaid.min.js').then(runMermaid)
    }

    window.pjax ? loadMermaid() : document.addEventListener('DOMContentLoaded', loadMermaid)
  }
})()</script><script>function loadUtterances () {
  let ele = document.createElement('script')
  ele.setAttribute('id', 'utterances_comment')
  ele.setAttribute('src', 'https://utteranc.es/client.js')
  ele.setAttribute('repo', 'Kevinello/gitalk')
  ele.setAttribute('issue-term', 'pathname')
  let nowTheme = document.documentElement.getAttribute('data-theme') === 'dark' ? 'photon-dark' : 'github-light'
  ele.setAttribute('theme', nowTheme)
  ele.setAttribute('crossorigin', 'anonymous')
  ele.setAttribute('async', 'true')
  document.getElementById('utterances-wrap').insertAdjacentElement('afterbegin',ele)
}

function utterancesTheme () {
  const iframe = document.querySelector('.utterances-frame')
  if (iframe) {
    const theme = document.documentElement.getAttribute('data-theme') === 'dark' ? 'photon-dark' : 'github-light'
    const message = {
      type: 'set-theme',
      theme: theme
    };
    iframe.contentWindow.postMessage(message, 'https://utteranc.es');
  }
}

if ('Utterances' === 'Utterances' || !false) {
  if (false) btf.loadComment(document.getElementById('utterances-wrap'), loadUtterances)
  else loadUtterances()
} else {
  function loadOtherComment () {
    loadUtterances()
  }
}</script><script>(()=>{
  const init = () => {
    twikoo.init(Object.assign({
      el: '#twikoo-wrap',
      envId: 'blog-comments-9gil6as164013b6c',
      region: '',
      onCommentLoaded: function () {
        btf.loadLightbox(document.querySelectorAll('#twikoo .tk-content img:not(.vemoji)'))
      }
    }, null))
  }

  const getCount = () => {
    twikoo.getCommentsCount({
      envId: 'blog-comments-9gil6as164013b6c',
      region: '',
      urls: [window.location.pathname],
      includeReply: false
    }).then(function (res) {
      document.getElementById('twikoo-count').innerText = res[0].count
    }).catch(function (err) {
      console.error(err);
    });
  }

  const runFn = () => {
    init()
    GLOBAL_CONFIG_SITE.isPost && getCount()
  }

  const loadTwikoo = () => {
    if (typeof twikoo === 'object') {
      setTimeout(runFn,0)
      return
    } 
    getScript('https://cdn.jsdelivr.net/npm/twikoo/dist/twikoo.all.min.js').then(runFn)
  }

  if ('Utterances' === 'Twikoo' || !false) {
    if (false) btf.loadComment(document.getElementById('twikoo-wrap'), loadTwikoo)
    else loadTwikoo()
  } else {
    window.loadOtherComment = () => {
      loadTwikoo()
    }
  }
})()</script></div><script async data-pjax src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script></div></body></html>